<!-- password-table.html -->
<div class="password-list" th:fragment="passwordTable">
    <h3>ğŸ“‹ Elenco delle password</h3>
    <div class="search-container">
        <input type="text" id="searchInput" class="search-input" 
               placeholder="ğŸ” Cerca per titolo...">
        <button onclick="clearSearch()" class="clear-search-btn">Pulisci Ricerca</button>
    </div>
    
    <!-- Messaggio nessun risultato -->
    <div id="noResults" class="no-results">
        <p>Nessuna password trovata con questo titolo.</p>
    </div>
    
    <!-- Verifica se passwords Ã¨ null o vuoto -->
    <div th:if="${passwords == null or passwords.empty}">
        <div class="empty-state">
            <p th:if="${passwords == null}">
                âŒ Errore nel caricamento dei dati. 
                <a th:href="@{/logout}">Riaccedi</a> o 
                <a th:href="@{/login}">reinserisci la master password</a>.
            </p>
            <p th:if="${passwords != null and passwords.empty}">
                Nessuna password salvata. 
                <a th:href="@{/new}">Aggiungine una!</a>
            </p>
        </div>
    </div>
    
    <button type="button" class="new-btn" onclick="window.location.href='/new'">
        â• Inserisci Nuovo Elemento
    </button>
    
    <!-- Tabella delle password -->
    <table th:if="${passwords != null and !passwords.empty}" class="password-table" id="passwordTable">
        <thead>
            <tr>
                <th>Titolo</th>
                <th>Username</th>
                <th>Password</th>
                <th>URL</th>
                <th>Azioni</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="password : ${passwords}">
                <td th:text="${password.title}"></td>
                <td th:text="${password.username}"></td>
                <td class="password-cell">
                    <span class="password-display" 
                          th:text="${password.decryptedPassword}"
                          th:attr="data-password=${password.decryptedPassword}"
                          title="Password">
                    </span>
                    <div class="action-buttons">
                        <button type="button" class="show-password-btn" 
                                onclick="toggleDisplayPassword(this)"
                                title="Mostra/Nascondi password">
                            ğŸ‘ï¸
                        </button>
                        <button type="button" class="copy-btn" 
                                onclick="copyPassword(this, '[[${password.decryptedPassword}]]')"
                                title="Copia password">
                            ğŸ“‹
                        </button>
                    </div>
                </td>
                <td class="url-cell">
                    <a th:if="${password.url}" th:href="${password.url}" th:text="${password.url}" target="_blank" title="Apri URL"></a>
                    <span th:unless="${password.url}">-</span>
                </td>
                <td>
                    <div class="action-buttons">
                        <a th:href="@{/edit/{id}(id=${password.id})}" class="edit-btn" 
                           title="Clicca per accedere ai dettagli da modificare">
                            âœï¸ Modifica
                        </a>
                        <a th:href="@{/delete/{id}(id=${password.id})}" class="delete-btn" 
                           onclick="return confirm('Sei sicuro di voler eliminare questa password?')"
                           title="Elimina l'elemento">
                            ğŸ—‘ï¸ Elimina
                        </a>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>