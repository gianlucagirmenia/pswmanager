<!-- password-table.html -->
<div class="password-list" th:fragment="passwordTable">
	
    <!-- Messaggio nessun risultato -->
    <div id="noResults" class="no-results">
        <p>Nessuna password trovata con questo titolo.</p>
    </div>
    
    <!-- Verifica se passwords Ã¨ null o vuoto -->
    <div th:if="${passwords == null or passwords.empty}">
        <div class="empty-state">
            <p th:if="${passwords == null}">
                âŒ Errore nel caricamento dei dati. 
                <a th:href="@{/logout}">Riaccedi</a> o 
                <a th:href="@{/login}">reinserisci la master password</a>.
            </p>
            <p th:if="${passwords != null and passwords.empty}">
                Nessuna password trovata. 
				<span th:if="${searchQuery}">Prova con un'altra ricerca.</span>
                <span th:unless="${searchQuery}"><a th:href="@{/new}">Aggiungine una!</a></span>
            </p>
        </div>
    </div>
	
	<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1px;">
		<div style="display: flex; gap: 10px; align-items: center;">
			<button type="button" class="new-btn" onclick="window.location.href='/new'">
				â• Inserisci Nuovo Elemento
			</button>
		</div>

		<div class="search-container">
		    <input type="text" id="searchInput" class="search-input" 
		           placeholder="ğŸ” Cerca per titolo..." 
		           th:attr="value=${searchQuery != null} ? ${searchQuery} : ''">
		    <button onclick="searchPasswords()" class="search-btn">Cerca</button>
		</div>
	</div>
	
	<!-- Include la paginazione -->
	<div th:replace="fragments/pagination :: pagination"></div>
    
    <!-- Tabella delle password -->
    <table th:if="${passwords != null and !passwords.empty}" class="password-table" id="passwordTable">
        <thead>
            <tr>
                <th>Titolo</th>
                <th>Username</th>
                <th>Password</th>
                <th>URL</th>
                <th>Azioni</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="password : ${passwords}">
                <td th:text="${password.title}"></td>
                <td th:text="${password.username}"></td>
                <td class="password-cell">
                    <span class="password-display" 
                          th:text="${password.decryptedPassword}"
                          th:attr="data-password=${password.decryptedPassword}"
                          title="Password">
                    </span>
                    <div class="action-buttons">
                        <button type="button" class="show-password-btn" 
                                onclick="toggleDisplayPassword(this)"
                                title="Mostra/Nascondi password">
                            ğŸ‘ï¸
                        </button>
                        <button type="button" class="copy-btn" 
                                onclick="copyPassword(this, '[[${password.decryptedPassword}]]')"
                                title="Copia password">
                            ğŸ“‹
                        </button>
                    </div>
                </td>
                <td class="url-cell">
                    <a th:if="${password.url}" th:href="${password.url}" th:text="${password.url}" target="_blank" title="Apri URL"></a>
                    <span th:unless="${password.url}">-</span>
                </td>
                <td>
					<div class="action-buttons">
						<button type="button" class="mod-btn" 
						        th:onclick="'window.location.href=\'' + @{/edit/{id}(id=${password.id})} + '\''"
						        title="Modifica">
						    âœï¸ Modifica
						</button>
						<button type="button" class="del-btn" 
						        th:onclick="'if(confirm(\'Sei sicuro di voler eliminare questa password?\')) window.location.href=\'' + @{/delete/{id}(id=${password.id})} + '\''"
						        title="Elimina">
						    ğŸ—‘ï¸ Elimina
						</button>
					</div>
                </td>
            </tr>
        </tbody>
    </table>
</div>